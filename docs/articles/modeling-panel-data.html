<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forecasting Panel Data • modeltime</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Forecasting Panel Data">
<meta property="og:description" content="modeltime">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modeltime</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/getting-started-with-modeltime.html">Getting Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Forecasting</li>
    <li>
      <a href="../articles/getting-started-with-modeltime.html">Getting Started with Modeltime</a>
    </li>
    <li>
      <a href="../articles/recursive-forecasting.html">Autoregressive Forecasting (Recursive)</a>
    </li>
    <li>
      <a href="../articles/parallel-processing.html">Hyperparameter Tuning &amp; Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/modeling-panel-data.html">Forecasting Panel Data</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Nested Forecasting</li>
    <li>
      <a href="../articles/nested-forecasting.html">Getting Started with Nested Forecasting</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Algorithms</li>
    <li>
      <a href="../articles/modeltime-model-list.html">Modeltime Algorithm Roadmap</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Developers</li>
    <li>
      <a href="../articles/extending-modeltime.html">Extending Modeltime (Developer Tools)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    API
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">API Functions</li>
    <li>
      <a href="../reference/index.html">
        <span class="fa fa-home"></span>
         
        Function Reference
      </a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Change History</li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ecosystem
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Forecast</li>
    <li>
      <a href="https://business-science.github.io/modeltime/">Modeltime (Forecasting)</a>
    </li>
    <li>
      <a href="https://business-science.github.io/timetk/">TimeTK (Time Series Analysis)</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Improve</li>
    <li>
      <a href="https://business-science.github.io/modeltime.ensemble/">Modeltime Ensemble (Blending Forecasts)</a>
    </li>
    <li>
      <a href="https://business-science.github.io/modeltime.resample/">Modeltime Resample (Backtesting)</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Scale</li>
    <li>
      <a href="https://business-science.github.io/modeltime.h2o/">Modeltime H2O (AutoML)</a>
    </li>
    <li>
      <a href="https://business-science.github.io/modeltime.gluonts/">Modeltime GluonTS (Deep Learning)</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/">
    <span class="fas fa-graduation-cap"></span>
     
    Learn
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/business-science/modeltime">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="modeling-panel-data_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Forecasting Panel Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/modeltime/blob/master/vignettes/modeling-panel-data.Rmd"><code>vignettes/modeling-panel-data.Rmd</code></a></small>
      <div class="hidden name"><code>modeling-panel-data.Rmd</code></div>

    </div>

    
    
<p><img src="panel_data_success.jpg" width="100%" style="display: block; margin: auto;"></p>
<p><br><img src="logo-modeltime.png" width="147" height="170" align="right"></p>
<p>Modeltime is designed for modeling <strong>Panel Data</strong>. In this short tutorial, we will explain what Panel Data Modeling is and demonstrate how to use the Modeltime Forecasting Workflow for multi-time series datasets (Panel Data).</p>
<div id="problem-forecast-iteration-is-not-scalable" class="section level1">
<h1 class="hasAnchor">
<a href="#problem-forecast-iteration-is-not-scalable" class="anchor"></a>Problem: Forecast Iteration is Not Scalable</h1>
<p><strong>Time series are increasing at an exponential rate.</strong> Organization-wide forecasting demands have changed from top-level to bottom-level forecasting, which has increased the number of forecasts that need to be made from the range of 1-100 to the range of 1,000-10,000.</p>
<p>Think of forecasting by customer for an organization that has <strong>10,000 customers</strong>. It becomes a <em>challenge</em> to make these forecasts one at a time in an iterative approach. As that organization grows, moving from 10,000 to 100,000 customers, <strong>forecasting with an iterative approach is not scalable.</strong></p>
<p><strong>Modeltime</strong> has been designed to take a different approach using <strong>Panel Data and Global Models</strong> (more on these concepts shortly). Using these approaches, we can dramatically increase the scale at which forecasts can be made. Prior limitations in the range of 1,000 to 10,000 forecasts become managable. Beyond is also possible with clustering techniques and making several panel models. <strong>We are only limited by RAM, not modeling time.</strong></p>
</div>
<div id="what-are-panel-data-and-global-models" class="section level1">
<h1 class="hasAnchor">
<a href="#what-are-panel-data-and-global-models" class="anchor"></a>What are Panel Data and Global Models?</h1>
<p>In it’s simplest form, <strong>Panel Data</strong> is a time series dataset that has more than one series. Each time series is stacked row-wise (on-top) of each other.</p>
<div class="figure" style="text-align: center">
<img src="panel_data.jpg" alt="Panel Data Structure" width="100%"><p class="caption">
Panel Data Structure
</p>
</div>
<p><strong>Traditional modeling techniques like ARIMA</strong> can only be used on one time series at a time. The widely accepted forecasting approach is to iterate through each time series producing a unique model and forecast for each time series identifier. The downside with this approach is that it’s expensive when you have many time series. Think of the number of products in a database. As the number of time series approaches the range of 1000-10,000, <strong>the iterative approach becomes unscalable.</strong></p>
<div class="figure" style="text-align: center">
<img src="panel_data_arima.jpg" alt="Problem: 1000 ARIMA Models Needed for 1000 Time Series" width="100%"><p class="caption">
Problem: 1000 ARIMA Models Needed for 1000 Time Series
</p>
</div>
<p><strong>Global Models</strong> are alternatives to the iterative approach. A Global Model is a single model that forecasts all time series at once. Global Models are highly scalable, which solves the problem of 1-10,000 time series. An example is an XGBoost Model, which can determine relationships for all 1000 time series panels with a single model.</p>
<div class="figure" style="text-align: center">
<img src="panel_data_xgboost.jpg" alt="Solution: A Single XGBOOST Model can Model 1000 Time Series" width="100%"><p class="caption">
Solution: A Single XGBOOST Model can Model 1000 Time Series
</p>
</div>
<p>The downside is that an iterative approach can be more accurate. To improve accuracy, <strong>feature engineering and localized model selection</strong> by time series identifier become critical to large-scale forecasting success. If interested, I teach proven feature engineering techniques in my <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/">Time Series Forecasting Course</a>.</p>
<div class="figure" style="text-align: center">
<img src="panel_data_success.jpg" alt="Modeling Panel Data" width="100%"><p class="caption">
Modeling Panel Data
</p>
</div>
</div>
<div id="modeltime-is-designed-for-panel-data" class="section level1">
<h1 class="hasAnchor">
<a href="#modeltime-is-designed-for-panel-data" class="anchor"></a>Modeltime is Designed for Panel Data</h1>
<p>While Modeltime can perform iterative modeling, <strong>Modeltime has been designed for Panel Data</strong> using:</p>
<ul>
<li><p><strong>Global Modeling:</strong> Global model Machine Learning and Deep Learning strategies using the Modeltime Ecosystem (e.g. <code>modeltime</code>, <code>modeltime.h2o</code>, and <code>modeltime.gluonts</code>).</p></li>
<li><p><strong>Feature Engineering</strong>: Developing calendar features, lagged features, and other time-based, window-based, and sequence-based features using <code>timetk</code>.</p></li>
<li><p><strong>Local Forecast Visualization</strong>: Visualizing multiple local time series forecasts at once.</p></li>
<li><p><strong>Global and Localized Accuracy Reporting</strong>: Generating out-of-sample accuracy both globally and at a local level by time series identifier (available in <code>modeltime</code> &gt;= 0.7.0)</p></li>
<li><p><strong>Global and Localized Confidence Intervals Reporting</strong>: Generating out-of-sample confidence intervals both globally and at a local level by time series identifier (available in <code>modeltime</code> &gt;= 0.7.0)</p></li>
</ul>
</div>
<div id="short-tutorial-on-panel-data" class="section level1">
<h1 class="hasAnchor">
<a href="#short-tutorial-on-panel-data" class="anchor"></a>Short Tutorial on Panel Data</h1>
<p>We’ll cover a short tutorial on modeling panel data with the <code>walmart_sales_weekly</code> dataset.</p>
<div id="load-libraries" class="section level2">
<h2 class="hasAnchor">
<a href="#load-libraries" class="anchor"></a>Load Libraries</h2>
<p>First, load the following libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime">modeltime</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/timetk">timetk</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="collect-data" class="section level2">
<h2 class="hasAnchor">
<a href="#collect-data" class="anchor"></a>Collect data</h2>
<p>Next, collect the <code>walmart_sales_weekly</code> dataset. The dataset consists of 1001 observations of revenue generated by a store-department combination on any given week. It contains:</p>
<ul>
<li>
<strong>7 Time Series Groups</strong> denoted by the “ID” column</li>
<li>The data is structured in <strong>Panel Data</strong> format</li>
<li>The time series groups will be modeled with a single <strong>Global Model</strong>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">walmart_sales_weekly</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">Date</span>, <span class="va">Weekly_Sales</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"date"</span>, <span class="st">"value"</span><span class="op">)</span><span class="op">)</span>

<span class="va">data</span>
<span class="co">#&gt; # A tibble: 1,001 × 3</span>
<span class="co">#&gt;    ID    date        value</span>
<span class="co">#&gt;    &lt;fct&gt; &lt;date&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1 1_1   2010-02-05 24924.</span>
<span class="co">#&gt;  2 1_1   2010-02-12 46039.</span>
<span class="co">#&gt;  3 1_1   2010-02-19 41596.</span>
<span class="co">#&gt;  4 1_1   2010-02-26 19404.</span>
<span class="co">#&gt;  5 1_1   2010-03-05 21828.</span>
<span class="co">#&gt;  6 1_1   2010-03-12 21043.</span>
<span class="co">#&gt;  7 1_1   2010-03-19 22137.</span>
<span class="co">#&gt;  8 1_1   2010-03-26 26229.</span>
<span class="co">#&gt;  9 1_1   2010-04-02 57258.</span>
<span class="co">#&gt; 10 1_1   2010-04-09 42961.</span>
<span class="co">#&gt; # … with 991 more rows</span></code></pre></div>
</div>
<div id="visualize-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-the-data" class="anchor"></a>Visualize the Data</h2>
<p>From visualizing, the weekly department revenue patterns emerge. Most of the series have yearly seasonality and long-term trends.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/plot_time_series.html">plot_time_series</a></span><span class="op">(</span>
    .date_var    <span class="op">=</span> <span class="va">date</span>, 
    .value       <span class="op">=</span> <span class="va">value</span>,
    .facet_ncol  <span class="op">=</span> <span class="fl">3</span>,
    .interactive <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span></code></pre></div>
<p><img src="modeling-panel-data_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="traintest-splitting" class="section level2">
<h2 class="hasAnchor">
<a href="#traintest-splitting" class="anchor"></a>Train/Test Splitting</h2>
<p>We can split the data into training and testing sets using <code><a href="https://rdrr.io/pkg/timetk/man/time_series_split.html">time_series_split()</a></code>. We’ll investigate the last 3-months of the year to test a global model on a 3-month forecast. The message on overlapping dates is to let us know that multiple time series are being processed using the last 3-month window for testing.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">splits</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/time_series_split.html">time_series_split</a></span><span class="op">(</span>assess <span class="op">=</span> <span class="st">"3 months"</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Using date_var: date</span>
<span class="co">#&gt; Data is not ordered by the 'date_var'. Resamples will be arranged by `date`.</span>
<span class="co">#&gt; Overlapping Timestamps Detected. Processing overlapping time series together using sliding windows.</span>

<span class="va">splits</span>
<span class="co">#&gt; &lt;Analysis/Assess/Total&gt;</span>
<span class="co">#&gt; &lt;917/84/1001&gt;</span></code></pre></div>
</div>
<div id="recipe" class="section level2">
<h2 class="hasAnchor">
<a href="#recipe" class="anchor"></a>Recipe</h2>
<p>We can move to preprocessing the data. We will use the <code>recipes</code> workflow for generating time series features. This results in 37 derived features for modeling. We can certainly include more features such as lags and rolling features, which are covered in the <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/">High-Performance Time Series Course</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rec_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html">recipe</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_mutate.html">step_mutate</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/step_timeseries_signature.html">step_timeseries_signature</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_rm.html">step_rm</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_zv.html">step_zv</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html">all_predictors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_dummy.html">step_dummy</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html">all_nominal_predictors</a></span><span class="op">(</span><span class="op">)</span>, one_hot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html">prep</a></span><span class="op">(</span><span class="va">rec_obj</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 38 × 4</span>
<span class="co">#&gt;    variable       type    role      source  </span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   </span>
<span class="co">#&gt;  1 value          numeric outcome   original</span>
<span class="co">#&gt;  2 date_index.num numeric predictor derived </span>
<span class="co">#&gt;  3 date_year      numeric predictor derived </span>
<span class="co">#&gt;  4 date_year.iso  numeric predictor derived </span>
<span class="co">#&gt;  5 date_half      numeric predictor derived </span>
<span class="co">#&gt;  6 date_quarter   numeric predictor derived </span>
<span class="co">#&gt;  7 date_month     numeric predictor derived </span>
<span class="co">#&gt;  8 date_month.xts numeric predictor derived </span>
<span class="co">#&gt;  9 date_day       numeric predictor derived </span>
<span class="co">#&gt; 10 date_mday      numeric predictor derived </span>
<span class="co">#&gt; # … with 28 more rows</span></code></pre></div>
</div>
<div id="machine-learning" class="section level2">
<h2 class="hasAnchor">
<a href="#machine-learning" class="anchor"></a>Machine Learning</h2>
<p>We’ll create an <code>xgboost</code> workflow by fitting the default xgboost model to our derived features from our in-sample training data set.</p>
<ul>
<li><p>Training the global xgboost model takes approximately 50 milliseconds.</p></li>
<li><p>Conversely, an ARIMA model might take several minutes to iterate through possible parameter combinations for each of the 7 time series.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Workflow</span>
<span class="va">wflw_xgb</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">add_model</span><span class="op">(</span>
        <span class="fu"><a href="https://parsnip.tidymodels.org/reference/boost_tree.html">boost_tree</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"xgboost"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">add_recipe</span><span class="op">(</span><span class="va">rec_obj</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>

<span class="va">wflw_xgb</span>
<span class="co">#&gt; ══ Workflow [trained] ══════════════════════════════════════════════════════════</span>
<span class="co">#&gt; Preprocessor: Recipe</span>
<span class="co">#&gt; Model: boost_tree()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; 5 Recipe Steps</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; • step_mutate()</span>
<span class="co">#&gt; • step_timeseries_signature()</span>
<span class="co">#&gt; • step_rm()</span>
<span class="co">#&gt; • step_zv()</span>
<span class="co">#&gt; • step_dummy()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; ##### xgb.Booster</span>
<span class="co">#&gt; raw: 58.3 Kb </span>
<span class="co">#&gt; call:</span>
<span class="co">#&gt;   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span>
<span class="co">#&gt;     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span>
<span class="co">#&gt;     subsample = 1, objective = "reg:squarederror"), data = x$data, </span>
<span class="co">#&gt;     nrounds = 15, watchlist = x$watchlist, verbose = 0, nthread = 1)</span>
<span class="co">#&gt; params (as set within xgb.train):</span>
<span class="co">#&gt;   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", objective = "reg:squarederror", nthread = "1", validate_parameters = "TRUE"</span>
<span class="co">#&gt; xgb.attributes:</span>
<span class="co">#&gt;   niter</span>
<span class="co">#&gt; callbacks:</span>
<span class="co">#&gt;   cb.evaluation.log()</span>
<span class="co">#&gt; # of features: 37 </span>
<span class="co">#&gt; niter: 15</span>
<span class="co">#&gt; nfeatures : 37 </span>
<span class="co">#&gt; evaluation_log:</span>
<span class="co">#&gt;     iter training_rmse</span>
<span class="co">#&gt;        1     46315.141</span>
<span class="co">#&gt;        2     33001.734</span>
<span class="co">#&gt; ---                   </span>
<span class="co">#&gt;       14      3676.542</span>
<span class="co">#&gt;       15      3373.945</span></code></pre></div>
</div>
<div id="modeltime-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#modeltime-workflow" class="anchor"></a>Modeltime Workflow</h2>
<p>We’ll step through the modeltime workflow, which is used to test many different models on the time series and organize the entire process.</p>
<div class="figure" style="text-align: center">
<img src="modeltime_workflow.jpg" alt="Modeltime Workflow" width="100%"><p class="caption">
Modeltime Workflow
</p>
</div>
<div id="create-a-modeltime-table" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-modeltime-table" class="anchor"></a>Create a Modeltime Table</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modeltime_table.html">modeltime_table</a></span><span class="op">(</span>
    <span class="va">wflw_xgb</span>
<span class="op">)</span>

<span class="va">model_tbl</span>
<span class="co">#&gt; # Modeltime Table</span>
<span class="co">#&gt; # A tibble: 1 × 3</span>
<span class="co">#&gt;   .model_id .model     .model_desc</span>
<span class="co">#&gt;       &lt;int&gt; &lt;list&gt;     &lt;chr&gt;      </span>
<span class="co">#&gt; 1         1 &lt;workflow&gt; XGBOOST</span></code></pre></div>
</div>
<div id="calibrate-by-id" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrate-by-id" class="anchor"></a>Calibrate by ID</h3>
<p>A new feature in <code>modeltime</code> 0.7.0 is the ability to calibrate by each time series. Calibration calculates the out of sample residual error.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calib_tbl</span> <span class="op">&lt;-</span> <span class="va">model_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_calibrate.html">modeltime_calibrate</a></span><span class="op">(</span>
      new_data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span>, 
      id       <span class="op">=</span> <span class="st">"ID"</span>
    <span class="op">)</span>

<span class="va">calib_tbl</span>
<span class="co">#&gt; # Modeltime Table</span>
<span class="co">#&gt; # A tibble: 1 × 5</span>
<span class="co">#&gt;   .model_id .model     .model_desc .type .calibration_data</span>
<span class="co">#&gt;       &lt;int&gt; &lt;list&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;list&gt;           </span>
<span class="co">#&gt; 1         1 &lt;workflow&gt; XGBOOST     Test  &lt;tibble [84 × 5]&gt;</span></code></pre></div>
</div>
</div>
<div id="measure-accuracy" class="section level2">
<h2 class="hasAnchor">
<a href="#measure-accuracy" class="anchor"></a>Measure Accuracy</h2>
<p>Next, we measure the global and local accuracy on the global model.</p>
<div id="global-accuracy" class="section level3">
<h3 class="hasAnchor">
<a href="#global-accuracy" class="anchor"></a>Global Accuracy</h3>
<p>The default is <code><a href="../reference/modeltime_accuracy.html">modeltime_accuracy(acc_by_id = FALSE)</a></code>, which returns a global model accuracy.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calib_tbl</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="../reference/modeltime_accuracy.html">modeltime_accuracy</a></span><span class="op">(</span>acc_by_id <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="../reference/table_modeltime_accuracy.html">table_modeltime_accuracy</a></span><span class="op">(</span>.interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="pkcmubsatj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pkcmubsatj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pkcmubsatj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pkcmubsatj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pkcmubsatj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pkcmubsatj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkcmubsatj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pkcmubsatj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pkcmubsatj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pkcmubsatj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pkcmubsatj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pkcmubsatj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pkcmubsatj .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pkcmubsatj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pkcmubsatj .gt_from_md > :first-child {
  margin-top: 0;
}

#pkcmubsatj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pkcmubsatj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pkcmubsatj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pkcmubsatj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkcmubsatj .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pkcmubsatj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkcmubsatj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pkcmubsatj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pkcmubsatj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkcmubsatj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pkcmubsatj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pkcmubsatj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pkcmubsatj .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pkcmubsatj .gt_left {
  text-align: left;
}

#pkcmubsatj .gt_center {
  text-align: center;
}

#pkcmubsatj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pkcmubsatj .gt_font_normal {
  font-weight: normal;
}

#pkcmubsatj .gt_font_bold {
  font-weight: bold;
}

#pkcmubsatj .gt_font_italic {
  font-style: italic;
}

#pkcmubsatj .gt_super {
  font-size: 65%;
}

#pkcmubsatj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Accuracy Table</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rsq</th>
    </tr></thead>
<tbody class="gt_table_body"><tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_right">3254.56</td>
<td class="gt_row gt_right">7.19</td>
<td class="gt_row gt_right">0.1</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">4574.52</td>
<td class="gt_row gt_right">0.98</td>
</tr></tbody>
</table>
</div>
</div>
<div id="local-accuracy" class="section level3">
<h3 class="hasAnchor">
<a href="#local-accuracy" class="anchor"></a>Local Accuracy</h3>
<p>By toggling <code><a href="../reference/modeltime_accuracy.html">modeltime_accuracy(acc_by_id = TRUE)</a></code>, we can obtain the local model accuracy. This can be useful for identifying specifically which time series the model does well on (and which it does poorly on). We can then <strong>apply model selection logic</strong> to select specific global models for specific IDs.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calib_tbl</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="../reference/modeltime_accuracy.html">modeltime_accuracy</a></span><span class="op">(</span>acc_by_id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="../reference/table_modeltime_accuracy.html">table_modeltime_accuracy</a></span><span class="op">(</span>.interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="rtnxgqujde" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rtnxgqujde .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rtnxgqujde .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtnxgqujde .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rtnxgqujde .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rtnxgqujde .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtnxgqujde .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtnxgqujde .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rtnxgqujde .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rtnxgqujde .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rtnxgqujde .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rtnxgqujde .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rtnxgqujde .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rtnxgqujde .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rtnxgqujde .gt_from_md > :first-child {
  margin-top: 0;
}

#rtnxgqujde .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rtnxgqujde .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rtnxgqujde .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#rtnxgqujde .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnxgqujde .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#rtnxgqujde .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtnxgqujde .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rtnxgqujde .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rtnxgqujde .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtnxgqujde .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtnxgqujde .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#rtnxgqujde .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtnxgqujde .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#rtnxgqujde .gt_left {
  text-align: left;
}

#rtnxgqujde .gt_center {
  text-align: center;
}

#rtnxgqujde .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rtnxgqujde .gt_font_normal {
  font-weight: normal;
}

#rtnxgqujde .gt_font_bold {
  font-weight: bold;
}

#rtnxgqujde .gt_font_italic {
  font-style: italic;
}

#rtnxgqujde .gt_super {
  font-size: 65%;
}

#rtnxgqujde .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Accuracy Table</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rsq</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_1</td>
<td class="gt_row gt_right">1138.25</td>
<td class="gt_row gt_right">6.19</td>
<td class="gt_row gt_right">0.85</td>
<td class="gt_row gt_right">5.93</td>
<td class="gt_row gt_right">1454.25</td>
<td class="gt_row gt_right">0.95</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_3</td>
<td class="gt_row gt_right">3403.81</td>
<td class="gt_row gt_right">18.47</td>
<td class="gt_row gt_right">0.57</td>
<td class="gt_row gt_right">16.96</td>
<td class="gt_row gt_right">4209.29</td>
<td class="gt_row gt_right">0.91</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_8</td>
<td class="gt_row gt_right">1891.35</td>
<td class="gt_row gt_right">4.93</td>
<td class="gt_row gt_right">0.86</td>
<td class="gt_row gt_right">5.07</td>
<td class="gt_row gt_right">2157.43</td>
<td class="gt_row gt_right">0.55</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_13</td>
<td class="gt_row gt_right">1201.11</td>
<td class="gt_row gt_right">2.92</td>
<td class="gt_row gt_right">0.53</td>
<td class="gt_row gt_right">2.97</td>
<td class="gt_row gt_right">1461.49</td>
<td class="gt_row gt_right">0.60</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_38</td>
<td class="gt_row gt_right">8036.27</td>
<td class="gt_row gt_right">10.52</td>
<td class="gt_row gt_right">0.99</td>
<td class="gt_row gt_right">10.64</td>
<td class="gt_row gt_right">8955.32</td>
<td class="gt_row gt_right">0.02</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_93</td>
<td class="gt_row gt_right">3493.69</td>
<td class="gt_row gt_right">4.50</td>
<td class="gt_row gt_right">0.34</td>
<td class="gt_row gt_right">4.64</td>
<td class="gt_row gt_right">4706.68</td>
<td class="gt_row gt_right">0.78</td>
</tr>
<tr>
<td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">XGBOOST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_center">1_95</td>
<td class="gt_row gt_right">3617.45</td>
<td class="gt_row gt_right">2.83</td>
<td class="gt_row gt_right">0.46</td>
<td class="gt_row gt_right">2.83</td>
<td class="gt_row gt_right">4184.46</td>
<td class="gt_row gt_right">0.72</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="forecast-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#forecast-the-data" class="anchor"></a>Forecast the Data</h2>
<p>The last step we’ll cover is forecasting the test dataset. This is useful to evaluate the model using a sampling of the time series within the panel dataset. In <code>modeltime</code> 0.7.0, we now have <code><a href="../reference/modeltime_forecast.html">modeltime_forecast(conf_by_id  = TRUE)</a></code> to allow the confidence intervals (prediction intervals) to be calculated by time series identifier. Note, that the <code><a href="../reference/modeltime_calibrate.html">modeltime_calibrate()</a></code> must have been performed with an <code>id</code> specified.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calib_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_forecast.html">modeltime_forecast</a></span><span class="op">(</span>
        new_data    <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span>,
        actual_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span>, <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>,
        conf_by_id  <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/plot_modeltime_forecast.html">plot_modeltime_forecast</a></span><span class="op">(</span>
        .facet_ncol  <span class="op">=</span> <span class="fl">3</span>,
        .interactive <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span></code></pre></div>
<p><img src="modeling-panel-data_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>We just showcased the <strong>Modeltime Workflow for Panel Data using a Global XGBOOST Model</strong>. But, this is a simple problem. And, <strong>there’s a lot more to learning time series:</strong></p>
<ul>
<li>Many more algorithms</li>
<li>Feature Engineering for Time Series</li>
<li>Ensembling</li>
<li>Machine Learning</li>
<li>Deep Learning</li>
<li>Scalable Modeling: 10,000+ time series</li>
</ul>
<p>Your probably thinking how am I ever going to learn time series forecasting. Here’s the solution that will save you years of struggling.</p>
</div>
<div id="take-the-high-performance-forecasting-course" class="section level1">
<h1 class="hasAnchor">
<a href="#take-the-high-performance-forecasting-course" class="anchor"></a>Take the High-Performance Forecasting Course</h1>
<blockquote>
<p>Become the forecasting expert for your organization</p>
</blockquote>
<p><a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/" target="_blank"><img src="https://www.filepicker.io/api/file/bKyqVAi5Qi64sS05QYLk" alt="High-Performance Time Series Forecasting Course" width="100%" style="box-shadow: 0 0 5px 2px rgba(0, 0, 0, .5);"></a></p>
<p><a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/"><em>High-Performance Time Series Course</em></a></p>
<div id="time-series-is-changing" class="section level3">
<h3 class="hasAnchor">
<a href="#time-series-is-changing" class="anchor"></a>Time Series is Changing</h3>
<p>Time series is changing. <strong>Businesses now need 10,000+ time series forecasts every day.</strong> This is what I call a <em>High-Performance Time Series Forecasting System (HPTSF)</em> - Accurate, Robust, and Scalable Forecasting.</p>
<p><strong>High-Performance Forecasting Systems will save companies by improving accuracy and scalability.</strong> Imagine what will happen to your career if you can provide your organization a “High-Performance Time Series Forecasting System” (HPTSF System).</p>
</div>
<div id="how-to-learn-high-performance-time-series-forecasting" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-learn-high-performance-time-series-forecasting" class="anchor"></a>How to Learn High-Performance Time Series Forecasting</h3>
<p>I teach how to build a HPTFS System in my <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting"><strong>High-Performance Time Series Forecasting Course</strong></a>. You will learn:</p>
<ul>
<li>
<strong>Time Series Machine Learning</strong> (cutting-edge) with <code>Modeltime</code> - 30+ Models (Prophet, ARIMA, XGBoost, Random Forest, &amp; many more)</li>
<li>
<strong>Deep Learning</strong> with <code>GluonTS</code> (Competition Winners)</li>
<li>
<strong>Time Series Preprocessing</strong>, Noise Reduction, &amp; Anomaly Detection</li>
<li>
<strong>Feature engineering</strong> using lagged variables &amp; external regressors</li>
<li><strong>Hyperparameter Tuning</strong></li>
<li><strong>Time series cross-validation</strong></li>
<li>
<strong>Ensembling</strong> Multiple Machine Learning &amp; Univariate Modeling Techniques (Competition Winner)</li>
<li>
<strong>Scalable Forecasting</strong> - Forecast 1000+ time series in parallel</li>
<li>and more.</li>
</ul>
<p class="text-center" style="font-size:24px;">
Become the Time Series Expert for your organization.
</p>
<br><p class="text-center" style="font-size:30px;">
<a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting">Take the High-Performance Time Series Forecasting Course</a>
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Dancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
