<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with Modeltime • modeltime</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started with Modeltime">
<meta property="og:description" content="modeltime">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modeltime</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/getting-started-with-modeltime.html">Getting Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Forecasting</li>
    <li>
      <a href="../articles/getting-started-with-modeltime.html">Getting Started with Modeltime</a>
    </li>
    <li>
      <a href="../articles/modeltime-model-list.html">Model List</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Developers</li>
    <li>
      <a href="../articles/extending-modeltime.html">Extending Modeltime (Developer Tools)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Key Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/business-science/modeltime">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting-started-with-modeltime_files/header-attrs-2.5/header-attrs.js"></script><script src="getting-started-with-modeltime_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="getting-started-with-modeltime_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="getting-started-with-modeltime_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with Modeltime</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/modeltime/blob/master/vignettes/getting-started-with-modeltime.Rmd"><code>vignettes/getting-started-with-modeltime.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started-with-modeltime.Rmd</code></div>

    </div>

    
    
<p><img src="forecast_plot.jpg" width="100%" style="display: block; margin: auto;"><br><img src="logo-modeltime.png" width="147" height="170" align="right"></p>
<p>Forecasting with <code>tidymodels</code> made easy! This short tutorial shows how you can use:</p>
<ul>
<li>
<strong>Modeltime models</strong> like <code><a href="../reference/arima_reg.html">arima_reg()</a></code>, <code><a href="../reference/arima_boost.html">arima_boost()</a></code>, <code><a href="../reference/exp_smoothing.html">exp_smoothing()</a></code>, <code><a href="../reference/prophet_reg.html">prophet_reg()</a></code>, <code><a href="../reference/prophet_boost.html">prophet_boost()</a></code>, and more</li>
<li>
<strong>Parsnip models</strong> like <code><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg()</a></code>, <code><a href="https://parsnip.tidymodels.org/reference/mars.html">mars()</a></code>, <code><a href="https://parsnip.tidymodels.org/reference/svm_rbf.html">svm_rbf()</a></code>, <code><a href="https://parsnip.tidymodels.org/reference/rand_forest.html">rand_forest()</a></code>, <code><a href="https://parsnip.tidymodels.org/reference/boost_tree.html">boost_tree()</a></code> and more</li>
</ul>
<p>To perform classical time series analysis and machine learning <strong><em>in one framework!</em></strong> See <a href="https://business-science.github.io/modeltime/articles/modeltime-model-list.html"><em>“Model List”</em></a> for the full list of <code>modeltime</code> models.</p>
<div id="the-modeltime-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#the-modeltime-workflow" class="anchor"></a>The Modeltime Workflow</h2>
<p>Here’s the general process and where the functions fit.</p>
<div class="figure" style="text-align: center">
<img src="modeltime_workflow.jpg" alt="The Modeltime Workflow" width="100%"><p class="caption">
The Modeltime Workflow
</p>
</div>
<p>Just follow the <code>modeltime</code> workflow, which is detailed in 6 convenient steps:</p>
<ol style="list-style-type: decimal">
<li>Collect data and split into training and test sets</li>
<li>Create &amp; Fit Multiple Models</li>
<li>Add fitted models to a <strong>Model Table</strong>
</li>
<li>
<strong>Calibrate</strong> the models to a testing set.</li>
<li>Perform Testing Set <em>Forecast</em> &amp; <em>Accuracy</em> Evaluation</li>
<li>
<strong>Refit</strong> the models to Full Dataset &amp; <em>Forecast</em> Forward</li>
</ol>
<p>Let’s go through a guided tour to kick the tires on <code>modeltime</code>.</p>
</div>
<div id="time-series-forecasting-example" class="section level2">
<h2 class="hasAnchor">
<a href="#time-series-forecasting-example" class="anchor"></a>Time Series Forecasting Example</h2>
<p>Load libraries to complete this short tutorial.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime">modeltime</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/timetk">timetk</a></span><span class="op">)</span>

<span class="co"># This toggles plots from plotly (interactive) to ggplot (static)</span>
<span class="va">interactive</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></code></pre></div>
<div id="step-1---collect-data-and-split-into-training-and-test-sets-" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1---collect-data-and-split-into-training-and-test-sets-" class="anchor"></a>Step 1 - Collect data and split into training and test sets.</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data</span>
<span class="va">m750</span> <span class="op">&lt;-</span> <span class="va">m4_monthly</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="st">"M750"</span><span class="op">)</span></code></pre></div>
<p>We can visualize the dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m750</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/plot_time_series.html">plot_time_series</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">value</span>, .interactive <span class="op">=</span> <span class="va">interactive</span><span class="op">)</span></code></pre></div>
<p><img src="getting-started-with-modeltime_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Let’s split the data into training and test sets using <code><a href="https://rsample.tidymodels.org/reference/initial_split.html">initial_time_split()</a></code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Split Data 80/20</span>
<span class="va">splits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">initial_time_split</a></span><span class="op">(</span><span class="va">m750</span>, prop <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></code></pre></div>
</div>
<div id="step-2---create-fit-multiple-models" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2---create-fit-multiple-models" class="anchor"></a>Step 2 - Create &amp; Fit Multiple Models</h3>
<p>We can easily create dozens of forecasting models by combining <code>modeltime</code> and <code>parsnip</code>. We can also use the <code>workflows</code> interface for adding preprocessing! Your forecasting possibilities are endless. Let’s get a few basic models developed:</p>
<ul>
<li>ARIMA</li>
<li>Exponential Smoothing</li>
<li>Linear Regression</li>
<li>MARS (Multivariate Adaptive Regression Splines)</li>
</ul>
<p><strong>Important note: Handling Date Features</strong></p>
<p><em>Modeltime models</em> (e.g. <code><a href="../reference/arima_reg.html">arima_reg()</a></code>) are created with a date or date time feature in the model. You will see that most models include a formula like <code><a href="https://generics.r-lib.org/reference/fit.html">fit(value ~ date, data)</a></code>.</p>
<p><em>Parsnip models</em> (e.g. <code><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg()</a></code>) typically should not have date features, but may contain derivatives of dates (e.g. month, year, etc). You will often see formulas like <code><a href="https://generics.r-lib.org/reference/fit.html">fit(value ~ as.numeric(date) + month(date), data)</a></code>.</p>
<div id="model-1-auto-arima-modeltime" class="section level4">
<h4 class="hasAnchor">
<a href="#model-1-auto-arima-modeltime" class="anchor"></a>Model 1: Auto ARIMA (Modeltime)</h4>
<p>First, we create a basic univariate ARIMA model using “Auto Arima” using <code><a href="../reference/arima_reg.html">arima_reg()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 1: auto_arima ----</span>
<span class="va">model_fit_arima_no_boost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arima_reg.html">arima_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"auto_arima"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; frequency = 12 observations per 1 year</span></code></pre></div>
</div>
<div id="model-2-boosted-auto-arima-modeltime" class="section level4">
<h4 class="hasAnchor">
<a href="#model-2-boosted-auto-arima-modeltime" class="anchor"></a>Model 2: Boosted Auto ARIMA (Modeltime)</h4>
<p>Next, we create a boosted ARIMA using <code><a href="../reference/arima_boost.html">arima_boost()</a></code>. Boosting uses XGBoost to model the ARIMA errors. Note that model formula contains both a date feature and derivatives of date - ARIMA uses the date - XGBoost uses the derivatives of date as regressors</p>
<p>Normally I’d use a preprocessing workflow for the month features using a function like <code><a href="https://rdrr.io/pkg/timetk/man/step_timeseries_signature.html">step_timeseries_signature()</a></code> from <code>timetk</code> to help reduce the complexity of the parsnip formula interface.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 2: arima_boost ----</span>
<span class="va">model_fit_arima_boosted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arima_boost.html">arima_boost</a></span><span class="op">(</span>
    min_n <span class="op">=</span> <span class="fl">2</span>,
    learn_rate <span class="op">=</span> <span class="fl">0.015</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"auto_arima_xgboost"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">date</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>,
        data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; frequency = 12 observations per 1 year</span></code></pre></div>
</div>
<div id="model-3-exponential-smoothing-modeltime" class="section level4">
<h4 class="hasAnchor">
<a href="#model-3-exponential-smoothing-modeltime" class="anchor"></a>Model 3: Exponential Smoothing (Modeltime)</h4>
<p>Next, create an Error-Trend-Season (ETS) model using an Exponential Smoothing State Space model. This is accomplished with <code><a href="../reference/exp_smoothing.html">exp_smoothing()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 3: ets ----</span>
<span class="va">model_fit_ets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_smoothing.html">exp_smoothing</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"ets"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; frequency = 12 observations per 1 year</span></code></pre></div>
</div>
<div id="model-4-prophet-modeltime" class="section level4">
<h4 class="hasAnchor">
<a href="#model-4-prophet-modeltime" class="anchor"></a>Model 4: Prophet (Modeltime)</h4>
<p>We’ll create a <code>prophet</code> model using <code><a href="../reference/prophet_reg.html">prophet_reg()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 4: prophet ----</span>
<span class="va">model_fit_prophet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prophet_reg.html">prophet_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"prophet"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Disabling weekly seasonality. Run prophet with weekly.seasonality=TRUE to override this.</span>
<span class="co">#&gt; Disabling daily seasonality. Run prophet with daily.seasonality=TRUE to override this.</span></code></pre></div>
</div>
<div id="model-5-linear-regression-parsnip" class="section level4">
<h4 class="hasAnchor">
<a href="#model-5-linear-regression-parsnip" class="anchor"></a>Model 5: Linear Regression (Parsnip)</h4>
<p>We can model time series linear regression (TSLM) using the <code><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg()</a></code> algorithm from <code>parsnip</code>. The following derivatives of date are used:</p>
<ul>
<li>
<em>Trend:</em> Modeled using <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric(date)</a></code>
</li>
<li>
<em>Seasonal:</em> Modeled using <code><a href="http://lubridate.tidyverse.org/reference/month.html">month(date)</a></code>
</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 5: lm ----</span>
<span class="va">model_fit_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
        data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="model-6-mars-workflow" class="section level4">
<h4 class="hasAnchor">
<a href="#model-6-mars-workflow" class="anchor"></a>Model 6: MARS (Workflow)</h4>
<p>We can model a Multivariate Adaptive Regression Spline model using <code><a href="https://parsnip.tidymodels.org/reference/mars.html">mars()</a></code>. I’ve modified the process to use a <code>workflow</code> to standardize the preprocessing of the features that are provided to the machine learning model (mars).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Model 6: earth ----</span>
<span class="va">model_spec_mars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/mars.html">mars</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"regression"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"earth"</span><span class="op">)</span> 

<span class="va">recipe_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html">recipe</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_date.html">step_date</a></span><span class="op">(</span><span class="va">date</span>, features <span class="op">=</span> <span class="st">"month"</span>, ordinal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_mutate.html">step_mutate</a></span><span class="op">(</span>date_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_normalize.html">step_normalize</a></span><span class="op">(</span><span class="va">date_num</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_rm.html">step_rm</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>
  
<span class="va">wflw_fit_mars</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">add_recipe</span><span class="op">(</span><span class="va">recipe_spec</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">add_model</span><span class="op">(</span><span class="va">model_spec_mars</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>OK, with these 6 models, we’ll show how easy it is to forecast.</p>
</div>
</div>
<div id="step-3---add-fitted-models-to-a-model-table-" class="section level3">
<h3 class="hasAnchor">
<a href="#step-3---add-fitted-models-to-a-model-table-" class="anchor"></a>Step 3 - Add fitted models to a Model Table.</h3>
<p>The next step is to add each of the models to a Modeltime Table using <code><a href="../reference/modeltime_table.html">modeltime_table()</a></code>. This step does some basic checking to make sure each of the models are fitted and that organizes into a scalable structure called a <strong><em>“Modeltime Table”</em></strong> that is used as part of our <em>forecasting workflow.</em></p>
<p>We have 6 models to add. A couple of notes before moving on:</p>
<ul>
<li>Note that some of the models have <em>tunable parameters</em>.</li>
<li>It’s expected that tuning and parameter selection is performed prior to incorporating into a Modeltime Table.</li>
<li>If you try to add an unfitted model, the <code><a href="../reference/modeltime_table.html">modeltime_table()</a></code> will complain (throw an informative error) saying you need to <code><a href="https://generics.r-lib.org/reference/fit.html">fit()</a></code> the model.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modeltime_table.html">modeltime_table</a></span><span class="op">(</span>
    <span class="va">model_fit_arima_no_boost</span>,
    <span class="va">model_fit_arima_boosted</span>,
    <span class="va">model_fit_ets</span>,
    <span class="va">model_fit_prophet</span>,
    <span class="va">model_fit_lm</span>,
    <span class="va">wflw_fit_mars</span>
<span class="op">)</span>

<span class="va">models_tbl</span>
<span class="co">#&gt; # Modeltime Table</span>
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   .model_id .model     .model_desc                              </span>
<span class="co">#&gt;       &lt;int&gt; &lt;list&gt;     &lt;chr&gt;                                    </span>
<span class="co">#&gt; 1         1 &lt;fit[+]&gt;   ARIMA(0,1,1)(0,1,1)[12]                  </span>
<span class="co">#&gt; 2         2 &lt;fit[+]&gt;   ARIMA(0,1,1)(0,1,1)[12] W/ XGBOOST ERRORS</span>
<span class="co">#&gt; 3         3 &lt;fit[+]&gt;   ETS(M,A,A)                               </span>
<span class="co">#&gt; 4         4 &lt;fit[+]&gt;   PROPHET                                  </span>
<span class="co">#&gt; 5         5 &lt;fit[+]&gt;   LM                                       </span>
<span class="co">#&gt; 6         6 &lt;workflow&gt; EARTH</span></code></pre></div>
</div>
<div id="step-4---calibrate-the-model-to-a-testing-set-" class="section level3">
<h3 class="hasAnchor">
<a href="#step-4---calibrate-the-model-to-a-testing-set-" class="anchor"></a>Step 4 - Calibrate the model to a testing set.</h3>
<p>Calibrating adds a new column, <code>.calibration_data</code>, with the test predictions and residuals inside. A few notes on Calibration:</p>
<ul>
<li>Calibration is how confidence intervals and accuracy metrics are determined</li>
<li>
<strong><em>Calibration Data</em></strong> is simply forecasting predictions and residuals that are calculated from out-of-sample data.</li>
<li>After calibrating, the calibration data follows the data through the forecasting workflow.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calibration_tbl</span> <span class="op">&lt;-</span> <span class="va">models_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_calibrate.html">modeltime_calibrate</a></span><span class="op">(</span>new_data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>

<span class="va">calibration_tbl</span>
<span class="co">#&gt; # Modeltime Table</span>
<span class="co">#&gt; # A tibble: 6 x 5</span>
<span class="co">#&gt;   .model_id .model     .model_desc                        .type .calibration_da…</span>
<span class="co">#&gt;       &lt;int&gt; &lt;list&gt;     &lt;chr&gt;                              &lt;chr&gt; &lt;list&gt;          </span>
<span class="co">#&gt; 1         1 &lt;fit[+]&gt;   ARIMA(0,1,1)(0,1,1)[12]            Test  &lt;tibble [31 × 4…</span>
<span class="co">#&gt; 2         2 &lt;fit[+]&gt;   ARIMA(0,1,1)(0,1,1)[12] W/ XGBOOS… Test  &lt;tibble [31 × 4…</span>
<span class="co">#&gt; 3         3 &lt;fit[+]&gt;   ETS(M,A,A)                         Test  &lt;tibble [31 × 4…</span>
<span class="co">#&gt; 4         4 &lt;fit[+]&gt;   PROPHET                            Test  &lt;tibble [31 × 4…</span>
<span class="co">#&gt; 5         5 &lt;fit[+]&gt;   LM                                 Test  &lt;tibble [31 × 4…</span>
<span class="co">#&gt; 6         6 &lt;workflow&gt; EARTH                              Test  &lt;tibble [31 × 4…</span></code></pre></div>
</div>
<div id="step-5---testing-set-forecast-accuracy-evaluation" class="section level3">
<h3 class="hasAnchor">
<a href="#step-5---testing-set-forecast-accuracy-evaluation" class="anchor"></a>Step 5 - Testing Set Forecast &amp; Accuracy Evaluation</h3>
<p>There are 2 critical parts to an evaluation.</p>
<ul>
<li>Visualizing the Forecast vs Test Data Set</li>
<li>Evaluating the Test (Out of Sample) Accuracy</li>
</ul>
<div id="a---visualizing-the-forecast-test" class="section level4">
<h4 class="hasAnchor">
<a href="#a---visualizing-the-forecast-test" class="anchor"></a>5A - Visualizing the Forecast Test</h4>
<p>Visualizing the Test Error is easy to do using the <strong>interactive plotly visualization (just toggle the visibility of the models using the Legend).</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calibration_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_forecast.html">modeltime_forecast</a></span><span class="op">(</span>
        new_data    <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span>,
        actual_data <span class="op">=</span> <span class="va">m750</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/plot_modeltime_forecast.html">plot_modeltime_forecast</a></span><span class="op">(</span>
      .legend_max_width <span class="op">=</span> <span class="fl">25</span>, <span class="co"># For mobile screens</span>
      .interactive      <span class="op">=</span> <span class="va">interactive</span>
    <span class="op">)</span></code></pre></div>
<p><img src="getting-started-with-modeltime_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>From visualizing the test set forecast:</p>
<ul>
<li>
<strong>Models 1&amp;2: ARIMA &amp; ARIMA Boost</strong> are performing well. Both models have “auto” components because we used Auto ARIMA. The XGBoost component has parameters that were specified. We can possibly get better accuracy by tuning, but because the ARIMA component is working well on this data, additional improvement may be low.</li>
<li>
<strong>Model 3: ETS(M,A,A)</strong> is performing the best. The 80% confidence interval is the most narrow of the bunch, indicating the hold out set is modeled well.</li>
<li>
<strong>Model 4: PROPHET</strong> is comparable to the ARIMA models, but has a slightly wider test error confidence interval.</li>
<li>
<strong>Model 5: LM</strong> is over-shooting the local trend. This is because the trend component is a simple linear line, which doesn’t account for the change points.</li>
<li>
<strong>Model 6: EARTH</strong> is overfitting the local trend. This is because we did not tune the number of change points, so the algorithm is auto-calculating the change points.</li>
</ul>
</div>
<div id="b---accuracy-metrics" class="section level4">
<h4 class="hasAnchor">
<a href="#b---accuracy-metrics" class="anchor"></a>5B - Accuracy Metrics</h4>
<p>We can use <code><a href="../reference/modeltime_accuracy.html">modeltime_accuracy()</a></code> to collect common accuracy metrics. The default reports the following metrics using <code>yardstick</code> functions:</p>
<ul>
<li>
<strong>MAE</strong> - Mean absolute error, <code>mae()</code>
</li>
<li>
<strong>MAPE</strong> - Mean absolute percentage error, <code>mape()</code>
</li>
<li>
<strong>MASE</strong> - Mean absolute scaled error, <code>mase()</code>
</li>
<li>
<strong>SMAPE</strong> - Symmetric mean absolute percentage error, <code>smape()</code>
</li>
<li>
<strong>RMSE</strong> - Root mean squared error, <code>rmse()</code>
</li>
<li>
<strong>RSQ</strong> - R-squared, <code>rsq()</code>
</li>
</ul>
<p>These of course can be customized following the rules for creating new yardstick metrics, but the defaults are very useful. Refer to <code>default_forecast_accuracy_metrics()</code> to learn more.</p>
<p>To make table-creation a bit easier, I’ve included <code><a href="../reference/table_modeltime_accuracy.html">table_modeltime_accuracy()</a></code> for outputing results in either interactive (<code>reactable</code>) or static (<code>gt</code>) tables.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calibration_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_accuracy.html">modeltime_accuracy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/table_modeltime_accuracy.html">table_modeltime_accuracy</a></span><span class="op">(</span>
        .interactive <span class="op">=</span> <span class="va">interactive</span>
    <span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#kwgewnnbcw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kwgewnnbcw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kwgewnnbcw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kwgewnnbcw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kwgewnnbcw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kwgewnnbcw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kwgewnnbcw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kwgewnnbcw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kwgewnnbcw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kwgewnnbcw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kwgewnnbcw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kwgewnnbcw .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#kwgewnnbcw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kwgewnnbcw .gt_from_md > :first-child {
  margin-top: 0;
}

#kwgewnnbcw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kwgewnnbcw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kwgewnnbcw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#kwgewnnbcw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kwgewnnbcw .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#kwgewnnbcw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kwgewnnbcw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kwgewnnbcw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kwgewnnbcw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kwgewnnbcw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kwgewnnbcw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#kwgewnnbcw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kwgewnnbcw .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#kwgewnnbcw .gt_left {
  text-align: left;
}

#kwgewnnbcw .gt_center {
  text-align: center;
}

#kwgewnnbcw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kwgewnnbcw .gt_font_normal {
  font-weight: normal;
}

#kwgewnnbcw .gt_font_bold {
  font-weight: bold;
}

#kwgewnnbcw .gt_font_italic {
  font-style: italic;
}

#kwgewnnbcw .gt_super {
  font-size: 65%;
}

#kwgewnnbcw .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="kwgewnnbcw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="9" class="gt_heading gt_title gt_font_normal" style>Accuracy Table</th>
    </tr>
<tr>
<th colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rsq</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_center">1</td>
      <td class="gt_row gt_left">ARIMA(0,1,1)(0,1,1)[12]</td>
      <td class="gt_row gt_left">Test</td>
      <td class="gt_row gt_right">151.33</td>
      <td class="gt_row gt_right">1.41</td>
      <td class="gt_row gt_right">0.52</td>
      <td class="gt_row gt_right">1.43</td>
      <td class="gt_row gt_right">197.71</td>
      <td class="gt_row gt_right">0.93</td>
    </tr>
<tr>
<td class="gt_row gt_center">2</td>
      <td class="gt_row gt_left">ARIMA(0,1,1)(0,1,1)[12] W/ XGBOOST ERRORS</td>
      <td class="gt_row gt_left">Test</td>
      <td class="gt_row gt_right">147.04</td>
      <td class="gt_row gt_right">1.37</td>
      <td class="gt_row gt_right">0.50</td>
      <td class="gt_row gt_right">1.39</td>
      <td class="gt_row gt_right">191.84</td>
      <td class="gt_row gt_right">0.93</td>
    </tr>
<tr>
<td class="gt_row gt_center">3</td>
      <td class="gt_row gt_left">ETS(M,A,A)</td>
      <td class="gt_row gt_left">Test</td>
      <td class="gt_row gt_right">77.00</td>
      <td class="gt_row gt_right">0.73</td>
      <td class="gt_row gt_right">0.26</td>
      <td class="gt_row gt_right">0.73</td>
      <td class="gt_row gt_right">90.27</td>
      <td class="gt_row gt_right">0.98</td>
    </tr>
<tr>
<td class="gt_row gt_center">4</td>
      <td class="gt_row gt_left">PROPHET</td>
      <td class="gt_row gt_left">Test</td>
      <td class="gt_row gt_right">177.51</td>
      <td class="gt_row gt_right">1.70</td>
      <td class="gt_row gt_right">0.61</td>
      <td class="gt_row gt_right">1.70</td>
      <td class="gt_row gt_right">234.65</td>
      <td class="gt_row gt_right">0.88</td>
    </tr>
<tr>
<td class="gt_row gt_center">5</td>
      <td class="gt_row gt_left">LM</td>
      <td class="gt_row gt_left">Test</td>
      <td class="gt_row gt_right">629.12</td>
      <td class="gt_row gt_right">6.01</td>
      <td class="gt_row gt_right">2.15</td>
      <td class="gt_row gt_right">5.81</td>
      <td class="gt_row gt_right">657.19</td>
      <td class="gt_row gt_right">0.91</td>
    </tr>
<tr>
<td class="gt_row gt_center">6</td>
      <td class="gt_row gt_left">EARTH</td>
      <td class="gt_row gt_left">Test</td>
      <td class="gt_row gt_right">709.83</td>
      <td class="gt_row gt_right">6.59</td>
      <td class="gt_row gt_right">2.42</td>
      <td class="gt_row gt_right">6.86</td>
      <td class="gt_row gt_right">782.82</td>
      <td class="gt_row gt_right">0.55</td>
    </tr>
</tbody>
</table></div>
<p>From the accuracy metrics:</p>
<ul>
<li><strong>Model 3: ETS is clearly the winner here with MAE of 77</strong></li>
<li>
<strong>Model 6: MARS</strong> is over-fitting the local trend. This comes out in the R-Squared of 0.55.</li>
</ul>
</div>
</div>
<div id="step-6---refit-to-full-dataset-forecast-forward" class="section level3">
<h3 class="hasAnchor">
<a href="#step-6---refit-to-full-dataset-forecast-forward" class="anchor"></a>Step 6 - Refit to Full Dataset &amp; Forecast Forward</h3>
<p>The final step is to refit the models to the full dataset using <code><a href="../reference/modeltime_refit.html">modeltime_refit()</a></code> and forecast them forward.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">refit_tbl</span> <span class="op">&lt;-</span> <span class="va">calibration_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_refit.html">modeltime_refit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m750</span><span class="op">)</span>

<span class="va">refit_tbl</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/modeltime_forecast.html">modeltime_forecast</a></span><span class="op">(</span>h <span class="op">=</span> <span class="st">"3 years"</span>, actual_data <span class="op">=</span> <span class="va">m750</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/plot_modeltime_forecast.html">plot_modeltime_forecast</a></span><span class="op">(</span>
      .legend_max_width <span class="op">=</span> <span class="fl">25</span>, <span class="co"># For mobile screens</span>
      .interactive      <span class="op">=</span> <span class="va">interactive</span>
    <span class="op">)</span></code></pre></div>
<p><img src="getting-started-with-modeltime_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="refitting---what-happened" class="section level2">
<h2 class="hasAnchor">
<a href="#refitting---what-happened" class="anchor"></a>Refitting - What happened?</h2>
<p><strong>The models have all changed!</strong> (Yes - this is the point of refitting)</p>
<ul>
<li>The <strong>LM</strong> model looks much better now because the linear trend line has now been fit to new data that follows the longer term trend.</li>
<li>The <strong>EARTH</strong> model has a trend that is more representative of the near-term trend.</li>
<li>The <strong>PROPHET</strong> model has a trend that is very similar to the EARTH model (this is because both modeling algorithms use changepoints to model trend, and prophet’s auto algorithm seems to be doing a better job at adapting).</li>
<li>The <strong>ETS</strong> model has changed from (M,A,A) to (A,A,A).</li>
<li>The <strong>ARIMA</strong> model have been updated and better capture the upswing.</li>
</ul>
<p><strong>This is the (potential) benefit of refitting.</strong></p>
<p>More often than not refitting is a good idea. Refitting:</p>
<ul>
<li>Retrieves your model and preprocessing steps</li>
<li>Refits the model to the new data</li>
<li>Recalculates any automations. This includes:
<ul>
<li>Recalculating the long-term trend for Linear Model</li>
<li>Recalculating the changepoints for the Earth Model</li>
<li>Recalculating the ARIMA and ETS parameters</li>
</ul>
</li>
<li>Preserves any parameter selections. This includes:
<ul>
<li>XGBoost Parameters in the Boosted ARIMA <code>min_n = 2</code>, <code>learn_rate = 0.015</code>.</li>
<li>Any other defaults that are not automatic calculations are used.</li>
</ul>
</li>
</ul>
</div>
<div id="learning-more" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-more" class="anchor"></a>Learning More</h2>
<p>
<iframe width="100%" height="450" src="https://www.youtube.com/embed/elQb4VzRINg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="box-shadow: 0 0 5px 2px rgba(0, 0, 0, .5);">
<span id="selection-marker-1" class="redactor-selection-marker"></span><span id="selection-marker-1" class="redactor-selection-marker"></span><span id="selection-marker-1" class="redactor-selection-marker"></span><span id="selection-marker-1" class="redactor-selection-marker"></span>
</iframe>
</p>
<p><em>My Talk on High-Performance Time Series Forecasting</em></p>
<p>Time series is changing. <strong>Businesses now need 10,000+ time series forecasts every day.</strong> This is what I call a <em>High-Performance Time Series Forecasting System (HPTSF)</em> - Accurate, Robust, and Scalable Forecasting.</p>
<p>You need to provide a “High-Performance Time Series Forecasting System” (HPTSF System). <strong>High-Performance Forecasting Systems will save companies MILLIONS of dollars.</strong></p>
<p>I teach how to build a HPTFS System in my <strong>High-Performance Time Series Forecasting Course</strong>. If interested in learning Scalable High-Performance Forecasting Strategies then <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting">take my course</a>. You will learn:</p>
<ul>
<li>Time Series Machine Learning (cutting-edge) with <code>Modeltime</code> - 30+ Models (Prophet, ARIMA, XGBoost, Random Forest, &amp; many more)</li>
<li>NEW - Deep Learning with <code>GluonTS</code> (Competition Winners)</li>
<li>Time Series Preprocessing, Noise Reduction, &amp; Anomaly Detection</li>
<li>Feature engineering using lagged variables &amp; external regressors</li>
<li>Hyperparameter Tuning</li>
<li>Time series cross-validation</li>
<li>Ensembling Multiple Machine Learning &amp; Univariate Modeling Techniques (Competition Winner)</li>
<li>Scalable Forecasting - Forecast 1000+ time series in parallel</li>
<li>and more.</li>
</ul>
<p class="text-center" style="font-size:30px;">
<a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting">Unlock the High-Performance Time Series Forecasting Course</a>
</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Dancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
