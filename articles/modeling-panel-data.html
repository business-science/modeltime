<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="modeltime">
<title>Forecasting with Global Models • modeltime</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Forecasting with Global Models">
<meta property="og:description" content="modeltime">
<meta property="og:image" content="https://business-science.github.io/modeltime/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-20GDZ5LL77"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-20GDZ5LL77');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">modeltime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started-with-modeltime.html">Start</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Getting Started</h6>
    <a class="dropdown-item" href="../articles/getting-started-with-modeltime.html">Getting Started with Modeltime</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Forecasting Many Time Series (Scale)</h6>
    <a class="dropdown-item" href="../articles/modeling-panel-data.html">Global Model Forecasting</a>
    <a class="dropdown-item" href="../articles/nested-forecasting.html">Iterative (Nested) Forecasting</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced Topics</h6>
    <a class="dropdown-item" href="../articles/modeltime-conformal-prediction.html">Conformal Prediction Interval Forecasting</a>
    <a class="dropdown-item" href="../articles/recursive-forecasting.html">Autoregressive (Recursive) Forecasting</a>
    <a class="dropdown-item" href="../articles/parallel-processing.html">Hyperparameter Tuning &amp; Parallel Processing</a>
    <a class="dropdown-item" href="../articles/modeltime-spark.html">The Modeltime Spark Backend</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Algorithms</h6>
    <a class="dropdown-item" href="../articles/modeltime-model-list.html">Modeltime Algorithm Roadmap</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developers</h6>
    <a class="dropdown-item" href="../articles/extending-modeltime.html">Extending Modeltime (Developer Tools)</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-api">API</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-api">
    <h6 class="dropdown-header" data-toc-skip>API Functions</h6>
    <a class="dropdown-item" href="../reference/index.html">
      <span class="fa fa-home"></span>
       
      Function Reference
    </a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Change History</h6>
    <a class="dropdown-item" href="../news/index.html">News</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-r-ecosystem">R Ecosystem</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-r-ecosystem">
    <h6 class="dropdown-header" data-toc-skip>Forecast</h6>
    <a class="dropdown-item" href="https://business-science.github.io/modeltime/">Modeltime (Forecasting)</a>
    <a class="external-link dropdown-item" href="https://business-science.github.io/timetk/">TimeTK (Time Series Analysis)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Improve</h6>
    <a class="dropdown-item" href="https://business-science.github.io/modeltime.ensemble/">Modeltime Ensemble (Blending Forecasts)</a>
    <a class="dropdown-item" href="https://business-science.github.io/modeltime.resample/">Modeltime Resample (Backtesting)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Scale</h6>
    <a class="dropdown-item" href="https://business-science.github.io/modeltime.h2o/">Modeltime H2O (AutoML)</a>
    <a class="dropdown-item" href="https://business-science.github.io/modeltime.gluonts/">Modeltime GluonTS (Deep Learning)</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-python">Python</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-python">
    <h6 class="dropdown-header" data-toc-skip>Forecast</h6>
    <a class="external-link dropdown-item" href="https://business-science.github.io/pytimetk/">Timetk for Python (Time Series Analysis)</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/">
    <span class="fas fa fas fa-graduation-cap"></span>
     
    Learn
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/business-science/modeltime">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Forecasting with Global Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/modeltime/blob/master/vignettes/modeling-panel-data.Rmd" class="external-link"><code>vignettes/modeling-panel-data.Rmd</code></a></small>
      <div class="d-none name"><code>modeling-panel-data.Rmd</code></div>
    </div>

    
    
<p><img src="panel_data_success.jpg" width="100%" style="display: block; margin: auto;"></p>
<p><br><img src="logo-modeltime.png" width="147" height="170" align="right"></p>
<p><strong>Why is global modeling important for time series?</strong>
For starters, the ability to forecast many time series with a single
model that is trained on many time series groups was a winning strategy
in recent Kaggle M5 Forecasting Competition. In fact, it’s the solution
we recommend in our <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/" class="external-link">Time
Series Course</a> when forecasting many time series as part of a
high-performance forecasting system. Why? Because it speeds up
forecasting, allowing the data scientist to more rapidly experiment and
find good solutions.</p>
<div class="section level2">
<h2 id="global-forecasting">Global Forecasting<a class="anchor" aria-label="anchor" href="#global-forecasting"></a>
</h2>
<p>In general, there are two methods for forecasting at scale (a slow
and accurate method and a fast and good method):</p>
<ol style="list-style-type: decimal">
<li><p><strong>Iterative Forecasting (Slow and Accurate):</strong> Best
for accuracy but takes <em>much longer</em> than global model (due to
for-loop iteration), results in many models (more memory required), and
is often needed to be run in parallel to scale to thousands of time
series (otherwise it can take days to complete). But, iterative
forecasting can yield great results. See <a href="https://business-science.github.io/modeltime/articles/nested-forecasting.html">Nested
Forecasting</a> for our Iterative Forecasting implementation.</p></li>
<li><p><strong>Global Modeling (Fast and Good):</strong> Best for
scalability to thousands of time series. Uses a Panel Data structure.
Can scale to 10,000+ time series easily because only a single model is
made that generates predictions (forecasts) for all of the time series.
Requires feature engineering and parameter tuning to get best
performance, which can be challenging for beginners.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="important-concepts">Important Concepts<a class="anchor" aria-label="anchor" href="#important-concepts"></a>
</h2>
<p>Students can struggle with global modeling. To help, I have a few
terms to cover that will help you understand how global modeling works
(and how it differs from iterative modeling).</p>
<div class="section level3">
<h3 id="panel-data">Panel Data<a class="anchor" aria-label="anchor" href="#panel-data"></a>
</h3>
<p><strong>The panel data structure</strong> is the format used for
global modeling. In it’s simplest form, <em>Panel Data</em> is a time
series dataset that has more than one series. Each time series is
stacked row-wise (on-top) of each other.</p>
<div class="figure" style="text-align: center">
<img src="panel_data.jpg" alt="Panel Data Structure" width="100%"><p class="caption">
Panel Data Structure
</p>
</div>
</div>
<div class="section level3">
<h3 id="traditional-modeling-iteration">Traditional Modeling (Iteration)<a class="anchor" aria-label="anchor" href="#traditional-modeling-iteration"></a>
</h3>
<p><strong>Traditional modeling techniques like ARIMA</strong> can only
be used on one time series at a time. The widely accepted forecasting
approach is to iterate through each time series producing a unique model
and forecast for each time series identifier. The downside with this
approach is that it’s expensive when you have many time series. Think of
the number of products in a database. As the number of time series
approaches the range of 1000-10,000, <strong>the iterative approach
becomes unscalable.</strong></p>
<div class="figure" style="text-align: center">
<img src="panel_data_arima.jpg" alt="Problem: 1000 ARIMA Models Needed for 1000 Time Series" width="100%"><p class="caption">
Problem: 1000 ARIMA Models Needed for 1000 Time Series
</p>
</div>
</div>
<div class="section level3">
<h3 id="global-modeling">Global Modeling<a class="anchor" aria-label="anchor" href="#global-modeling"></a>
</h3>
<p><strong>Global Models</strong> are alternatives to the iterative
approach. A Global Model is a single model that forecasts all time
series at once. Global Models are highly scalable, which solves the
problem of 1-10,000 time series. An example is an XGBoost Model, which
can determine relationships for all 1000 time series panels with a
single model.</p>
<div class="figure" style="text-align: center">
<img src="panel_data_xgboost.jpg" alt="Solution: A Single XGBOOST Model can Model 1000 Time Series" width="100%"><p class="caption">
Solution: A Single XGBOOST Model can Model 1000 Time Series
</p>
</div>
</div>
<div class="section level3">
<h3 id="importance-of-feature-engineering">Importance of Feature Engineering<a class="anchor" aria-label="anchor" href="#importance-of-feature-engineering"></a>
</h3>
<p>The downside is that an global approach can be less accurate. To
improve accuracy, <strong>feature engineering and localized model
selection</strong> by time series identifier become critical to
large-scale forecasting success. We recommend learning feature
engineering techniques that are proven to get results in our <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/" class="external-link">Time
Series Forecasting Course</a>.</p>
<div class="figure" style="text-align: center">
<img src="panel_data_success.jpg" alt="Modeling Panel Data" width="100%"><p class="caption">
Modeling Panel Data
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>We’ll cover a short tutorial on global forecasting. The first thing
to do is to load the following libraries:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime" class="external-link">modeltime</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/timetk" class="external-link">timetk</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h3>
<p>Next, let’s use the <code>walmart_sales_weekly</code> dataset that
comes with <code>timetk</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_tbl</span> <span class="op">&lt;-</span> <span class="va">walmart_sales_weekly</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, date <span class="op">=</span> <span class="va">Date</span>, value <span class="op">=</span> <span class="va">Weekly_Sales</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,001 × 3</span></span></span>
<span><span class="co">#&gt;    id    date        value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1_1   2010-02-05 <span style="text-decoration: underline;">24</span>924.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1_1   2010-02-12 <span style="text-decoration: underline;">46</span>039.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1_1   2010-02-19 <span style="text-decoration: underline;">41</span>596.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1_1   2010-02-26 <span style="text-decoration: underline;">19</span>404.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1_1   2010-03-05 <span style="text-decoration: underline;">21</span>828.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1_1   2010-03-12 <span style="text-decoration: underline;">21</span>043.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1_1   2010-03-19 <span style="text-decoration: underline;">22</span>137.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1_1   2010-03-26 <span style="text-decoration: underline;">26</span>229.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1_1   2010-04-02 <span style="text-decoration: underline;">57</span>258.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1_1   2010-04-09 <span style="text-decoration: underline;">42</span>961.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 991 more rows</span></span></span></code></pre></div>
<p>The dataset is that is already set up for panel data modeling. The
important columns are:</p>
<ul>
<li><p>“id”: This separates the time series groups (in this case these
represent sales from departments in a walmart store)</p></li>
<li><p>“date”: This is the weekly sales period</p></li>
<li><p>“value”: This is the value for sales during the week and
store/department</p></li>
</ul>
<p>We can visualize this by time series group to expose the differences
in sales by department.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/plot_time_series.html" class="external-link">plot_time_series</a></span><span class="op">(</span></span>
<span>    <span class="va">date</span>, <span class="va">value</span>, .interactive <span class="op">=</span> <span class="cn">F</span>, .facet_ncol <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="modeling-panel-data_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We can clearly see that there are 7 time series groups with different
weekly sales patterns.</p>
</div>
<div class="section level3">
<h3 id="traintest-splitting">Train/Test Splitting<a class="anchor" aria-label="anchor" href="#traintest-splitting"></a>
</h3>
<p>We can split the data into training and testing sets using
<code><a href="https://rdrr.io/pkg/timetk/man/time_series_split.html" class="external-link">time_series_split()</a></code>. We’ll investigate the last 3-months of
the year to test a global model on a 3-month forecast. The message on
overlapping dates is to let us know that multiple time series are being
processed using the last 3-month window for testing.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splits</span> <span class="op">&lt;-</span> <span class="va">data_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/time_series_split.html" class="external-link">time_series_split</a></span><span class="op">(</span></span>
<span>    assess     <span class="op">=</span> <span class="st">"3 months"</span>, </span>
<span>    cumulative <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Using date_var: date</span></span>
<span><span class="co">#&gt; Data is not ordered by the 'date_var'. Resamples will be arranged by `date`.</span></span>
<span><span class="co">#&gt; Overlapping Timestamps Detected. Processing overlapping time series together using sliding windows.</span></span>
<span></span>
<span><span class="va">splits</span></span>
<span><span class="co">#&gt; &lt;Analysis/Assess/Total&gt;</span></span>
<span><span class="co">#&gt; &lt;917/84/1001&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recipe">Recipe<a class="anchor" aria-label="anchor" href="#recipe"></a>
</h3>
<p><strong>Next, we need to preprocess the data.</strong> This is where
we add good features to imporve our global model performance. We will
use the <code>recipes</code> workflow for generating time series
features.</p>
<ul>
<li><p><code><a href="https://recipes.tidymodels.org/reference/step_mutate_at.html" class="external-link">step_mutate_at()</a></code>: Applies a function to one or more
columns. Used to remove extra unused levels in our categorical ID
column.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/timetk/man/step_timeseries_signature.html" class="external-link">step_timeseries_signature()</a></code>: Used to add calendar
features based on our date column</p></li>
<li><p><code><a href="https://recipes.tidymodels.org/reference/step_rm.html" class="external-link">step_rm()</a></code>: Used to remove the date column. Machine
Learning algorithms like XGBoost don’t handle date columns very
well.</p></li>
<li><p><code><a href="https://recipes.tidymodels.org/reference/step_zv.html" class="external-link">step_zv()</a></code>: Used to remove any zero variance
features. Features with no variance don’t add useful information to our
model.</p></li>
<li><p><code><a href="https://recipes.tidymodels.org/reference/step_dummy.html" class="external-link">step_dummy()</a></code>: Used to convert categorical features
to binary one-hot encoded features that algorithms like XGBoost can
model more effectively.</p></li>
</ul>
<p>This results in 37 derived features for modeling. We can certainly
include more features such as lags and rolling features that are known
to improve results. These concepts and more are covered in the <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/" class="external-link">High-Performance
Time Series Course</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_mutate_at.html" class="external-link">step_mutate_at</a></span><span class="op">(</span><span class="va">id</span>, fn <span class="op">=</span> <span class="va">droplevels</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/step_timeseries_signature.html" class="external-link">step_timeseries_signature</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_rm.html" class="external-link">step_rm</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_zv.html" class="external-link">step_zv</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_dummy.html" class="external-link">step_dummy</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_nominal_predictors</a></span><span class="op">(</span><span class="op">)</span>, one_hot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec_obj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 38 × 4</span></span></span>
<span><span class="co">#&gt;    variable       type      role      source  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> value          <span style="color: #949494;">&lt;chr [2]&gt;</span> outcome   original</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> date_index.num <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> date_year      <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> date_year.iso  <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> date_half      <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> date_quarter   <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> date_month     <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> date_month.xts <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> date_day       <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> date_mday      <span style="color: #949494;">&lt;chr [2]&gt;</span> predictor derived </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 28 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="machine-learning">Machine Learning<a class="anchor" aria-label="anchor" href="#machine-learning"></a>
</h3>
<p>We’ll create an <code>xgboost</code> workflow by fitting the default
xgboost model to our derived features from our in-sample training data
set.</p>
<ul>
<li><p>Training the global xgboost model takes approximately 50
milliseconds.</p></li>
<li><p>Conversely, an ARIMA model might take several minutes to iterate
through possible parameter combinations for each of the 7 time
series.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Workflow</span></span>
<span><span class="va">wflw_xgb</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">add_model</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://parsnip.tidymodels.org/reference/boost_tree.html" class="external-link">boost_tree</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"xgboost"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">add_recipe</span><span class="op">(</span><span class="va">rec_obj</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wflw_xgb</span></span>
<span><span class="co">#&gt; ══ Workflow [trained] ══════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> boost_tree()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; 5 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • step_mutate_at()</span></span>
<span><span class="co">#&gt; • step_timeseries_signature()</span></span>
<span><span class="co">#&gt; • step_rm()</span></span>
<span><span class="co">#&gt; • step_zv()</span></span>
<span><span class="co">#&gt; • step_dummy()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; ##### xgb.Booster</span></span>
<span><span class="co">#&gt; raw: 46.6 Kb </span></span>
<span><span class="co">#&gt; call:</span></span>
<span><span class="co">#&gt;   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span><span class="co">#&gt;     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span><span class="co">#&gt;     subsample = 1), data = x$data, nrounds = 15, watchlist = x$watchlist, </span></span>
<span><span class="co">#&gt;     verbose = 0, nthread = 1, objective = "reg:squarederror")</span></span>
<span><span class="co">#&gt; params (as set within xgb.train):</span></span>
<span><span class="co">#&gt;   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", nthread = "1", objective = "reg:squarederror", validate_parameters = "TRUE"</span></span>
<span><span class="co">#&gt; xgb.attributes:</span></span>
<span><span class="co">#&gt;   niter</span></span>
<span><span class="co">#&gt; callbacks:</span></span>
<span><span class="co">#&gt;   cb.evaluation.log()</span></span>
<span><span class="co">#&gt; # of features: 37 </span></span>
<span><span class="co">#&gt; niter: 15</span></span>
<span><span class="co">#&gt; nfeatures : 37 </span></span>
<span><span class="co">#&gt; evaluation_log:</span></span>
<span><span class="co">#&gt;     iter training_rmse</span></span>
<span><span class="co">#&gt;        1     46315.130</span></span>
<span><span class="co">#&gt;        2     33003.670</span></span>
<span><span class="co">#&gt; ---                   </span></span>
<span><span class="co">#&gt;       14      3554.521</span></span>
<span><span class="co">#&gt;       15      3423.419</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modeltime-workflow">Modeltime Workflow<a class="anchor" aria-label="anchor" href="#modeltime-workflow"></a>
</h3>
<p>We’ll step through the modeltime workflow, which is used to test many
different models on the time series and organize the entire process.</p>
<div class="figure" style="text-align: center">
<img src="modeltime_workflow.jpg" alt="Modeltime Workflow" width="100%"><p class="caption">
Modeltime Workflow
</p>
</div>
<div class="section level4">
<h4 id="step-1-create-a-modeltime-table">Step 1: Create a Modeltime Table<a class="anchor" aria-label="anchor" href="#step-1-create-a-modeltime-table"></a>
</h4>
<p>The first step is to create a Modeltime Table with
<code><a href="../reference/modeltime_table.html">modeltime_table()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modeltime_table.html">modeltime_table</a></span><span class="op">(</span></span>
<span>    <span class="va">wflw_xgb</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_tbl</span></span>
<span><span class="co">#&gt; # Modeltime Table</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   .model_id .model     .model_desc</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 <span style="color: #949494;">&lt;workflow&gt;</span> XGBOOST</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-calibrate-by-id">Step 2: Calibrate by ID<a class="anchor" aria-label="anchor" href="#step-2-calibrate-by-id"></a>
</h4>
<p>Next, we need to calibrate, which calculates the forecast error on
our test set. Use <code><a href="../reference/modeltime_calibrate.html">modeltime_calibrate()</a></code> to perform
calibration. Note that when we add the <code>id</code>, we are able to
track the the out-of-sample residual error by the “id” column.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calib_tbl</span> <span class="op">&lt;-</span> <span class="va">model_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/modeltime_calibrate.html">modeltime_calibrate</a></span><span class="op">(</span></span>
<span>      new_data <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span>, </span>
<span>      id       <span class="op">=</span> <span class="st">"id"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">calib_tbl</span></span>
<span><span class="co">#&gt; # Modeltime Table</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   .model_id .model     .model_desc .type .calibration_data</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 <span style="color: #949494;">&lt;workflow&gt;</span> XGBOOST     Test  <span style="color: #949494;">&lt;tibble [84 × 5]&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-3-measure-test-accuracy">Step 3: Measure Test Accuracy<a class="anchor" aria-label="anchor" href="#step-3-measure-test-accuracy"></a>
</h4>
<p>Next, we measure the global and local accuracy on the global
model.</p>
<div class="section level5">
<h5 id="global-accuracy">Global Accuracy<a class="anchor" aria-label="anchor" href="#global-accuracy"></a>
</h5>
<p>The default is <code>modeltime_accuracy(acc_by_id = FALSE)</code>,
which returns a global model accuracy.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calib_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/modeltime_accuracy.html">modeltime_accuracy</a></span><span class="op">(</span>acc_by_id <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/table_modeltime_accuracy.html">table_modeltime_accuracy</a></span><span class="op">(</span>.interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div id="ozdceeioih" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ozdceeioih table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ozdceeioih thead, #ozdceeioih tbody, #ozdceeioih tfoot, #ozdceeioih tr, #ozdceeioih td, #ozdceeioih th {
  border-style: none;
}

#ozdceeioih p {
  margin: 0;
  padding: 0;
}

#ozdceeioih .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ozdceeioih .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ozdceeioih .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ozdceeioih .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ozdceeioih .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ozdceeioih .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozdceeioih .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ozdceeioih .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ozdceeioih .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ozdceeioih .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ozdceeioih .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ozdceeioih .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ozdceeioih .gt_spanner_row {
  border-bottom-style: hidden;
}

#ozdceeioih .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ozdceeioih .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ozdceeioih .gt_from_md > :first-child {
  margin-top: 0;
}

#ozdceeioih .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ozdceeioih .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ozdceeioih .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ozdceeioih .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ozdceeioih .gt_row_group_first td {
  border-top-width: 2px;
}

#ozdceeioih .gt_row_group_first th {
  border-top-width: 2px;
}

#ozdceeioih .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozdceeioih .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ozdceeioih .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ozdceeioih .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozdceeioih .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozdceeioih .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ozdceeioih .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ozdceeioih .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ozdceeioih .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozdceeioih .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ozdceeioih .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozdceeioih .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ozdceeioih .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozdceeioih .gt_left {
  text-align: left;
}

#ozdceeioih .gt_center {
  text-align: center;
}

#ozdceeioih .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ozdceeioih .gt_font_normal {
  font-weight: normal;
}

#ozdceeioih .gt_font_bold {
  font-weight: bold;
}

#ozdceeioih .gt_font_italic {
  font-style: italic;
}

#ozdceeioih .gt_super {
  font-size: 65%;
}

#ozdceeioih .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ozdceeioih .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ozdceeioih .gt_indent_1 {
  text-indent: 5px;
}

#ozdceeioih .gt_indent_2 {
  text-indent: 10px;
}

#ozdceeioih .gt_indent_3 {
  text-indent: 15px;
}

#ozdceeioih .gt_indent_4 {
  text-indent: 20px;
}

#ozdceeioih .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Accuracy Table</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".model_id">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".model_desc">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".type">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mae">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mape">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mase">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="smape">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rmse">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rsq">rsq</th>
    </tr>
</thead>
<tbody class="gt_table_body"><tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="mae" class="gt_row gt_right">3698.69</td>
<td headers="mape" class="gt_row gt_right">8.3</td>
<td headers="mase" class="gt_row gt_right">0.11</td>
<td headers="smape" class="gt_row gt_right">8.17</td>
<td headers="rmse" class="gt_row gt_right">5059.45</td>
<td headers="rsq" class="gt_row gt_right">0.98</td>
</tr></tbody>
</table>
</div>
</div>
<div class="section level5">
<h5 id="local-accuracy">Local Accuracy<a class="anchor" aria-label="anchor" href="#local-accuracy"></a>
</h5>
<p>By toggling <code>modeltime_accuracy(acc_by_id = TRUE)</code>, we can
obtain the local model accuracy. This can be useful for identifying
specifically which time series the model does well on (and which it does
poorly on). We can then <strong>apply model selection logic</strong> to
select specific global models for specific IDs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calib_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/modeltime_accuracy.html">modeltime_accuracy</a></span><span class="op">(</span>acc_by_id <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/table_modeltime_accuracy.html">table_modeltime_accuracy</a></span><span class="op">(</span>.interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div id="wilemdajrg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wilemdajrg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wilemdajrg thead, #wilemdajrg tbody, #wilemdajrg tfoot, #wilemdajrg tr, #wilemdajrg td, #wilemdajrg th {
  border-style: none;
}

#wilemdajrg p {
  margin: 0;
  padding: 0;
}

#wilemdajrg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wilemdajrg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wilemdajrg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wilemdajrg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wilemdajrg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wilemdajrg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wilemdajrg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wilemdajrg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wilemdajrg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wilemdajrg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wilemdajrg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wilemdajrg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wilemdajrg .gt_spanner_row {
  border-bottom-style: hidden;
}

#wilemdajrg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wilemdajrg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wilemdajrg .gt_from_md > :first-child {
  margin-top: 0;
}

#wilemdajrg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wilemdajrg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wilemdajrg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wilemdajrg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wilemdajrg .gt_row_group_first td {
  border-top-width: 2px;
}

#wilemdajrg .gt_row_group_first th {
  border-top-width: 2px;
}

#wilemdajrg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wilemdajrg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wilemdajrg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wilemdajrg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wilemdajrg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wilemdajrg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wilemdajrg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wilemdajrg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wilemdajrg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wilemdajrg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wilemdajrg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wilemdajrg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wilemdajrg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wilemdajrg .gt_left {
  text-align: left;
}

#wilemdajrg .gt_center {
  text-align: center;
}

#wilemdajrg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wilemdajrg .gt_font_normal {
  font-weight: normal;
}

#wilemdajrg .gt_font_bold {
  font-weight: bold;
}

#wilemdajrg .gt_font_italic {
  font-style: italic;
}

#wilemdajrg .gt_super {
  font-size: 65%;
}

#wilemdajrg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wilemdajrg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wilemdajrg .gt_indent_1 {
  text-indent: 5px;
}

#wilemdajrg .gt_indent_2 {
  text-indent: 10px;
}

#wilemdajrg .gt_indent_3 {
  text-indent: 15px;
}

#wilemdajrg .gt_indent_4 {
  text-indent: 20px;
}

#wilemdajrg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Accuracy Table</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".model_id">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".model_desc">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".type">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="id">id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mae">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mape">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mase">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="smape">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rmse">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rsq">rsq</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_1</td>
<td headers="mae" class="gt_row gt_right">2125.99</td>
<td headers="mape" class="gt_row gt_right">10.83</td>
<td headers="mase" class="gt_row gt_right">1.59</td>
<td headers="smape" class="gt_row gt_right">10.30</td>
<td headers="rmse" class="gt_row gt_right">2596.97</td>
<td headers="rsq" class="gt_row gt_right">0.50</td>
</tr>
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_3</td>
<td headers="mae" class="gt_row gt_right">3397.33</td>
<td headers="mape" class="gt_row gt_right">18.67</td>
<td headers="mase" class="gt_row gt_right">0.57</td>
<td headers="smape" class="gt_row gt_right">17.60</td>
<td headers="rmse" class="gt_row gt_right">4048.49</td>
<td headers="rsq" class="gt_row gt_right">0.91</td>
</tr>
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_8</td>
<td headers="mae" class="gt_row gt_right">2086.84</td>
<td headers="mape" class="gt_row gt_right">5.45</td>
<td headers="mase" class="gt_row gt_right">0.95</td>
<td headers="smape" class="gt_row gt_right">5.62</td>
<td headers="rmse" class="gt_row gt_right">2283.70</td>
<td headers="rsq" class="gt_row gt_right">0.67</td>
</tr>
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_13</td>
<td headers="mae" class="gt_row gt_right">1596.47</td>
<td headers="mape" class="gt_row gt_right">3.86</td>
<td headers="mase" class="gt_row gt_right">0.70</td>
<td headers="smape" class="gt_row gt_right">3.96</td>
<td headers="rmse" class="gt_row gt_right">1913.82</td>
<td headers="rsq" class="gt_row gt_right">0.53</td>
</tr>
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_38</td>
<td headers="mae" class="gt_row gt_right">8345.09</td>
<td headers="mape" class="gt_row gt_right">10.77</td>
<td headers="mase" class="gt_row gt_right">1.03</td>
<td headers="smape" class="gt_row gt_right">10.99</td>
<td headers="rmse" class="gt_row gt_right">9685.67</td>
<td headers="rsq" class="gt_row gt_right">0.01</td>
</tr>
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_93</td>
<td headers="mae" class="gt_row gt_right">4278.75</td>
<td headers="mape" class="gt_row gt_right">5.37</td>
<td headers="mase" class="gt_row gt_right">0.42</td>
<td headers="smape" class="gt_row gt_right">5.57</td>
<td headers="rmse" class="gt_row gt_right">5440.12</td>
<td headers="rsq" class="gt_row gt_right">0.75</td>
</tr>
<tr>
<td headers=".model_id" class="gt_row gt_right">1</td>
<td headers=".model_desc" class="gt_row gt_left">XGBOOST</td>
<td headers=".type" class="gt_row gt_left">Test</td>
<td headers="id" class="gt_row gt_center">1_95</td>
<td headers="mae" class="gt_row gt_right">4060.36</td>
<td headers="mape" class="gt_row gt_right">3.14</td>
<td headers="mase" class="gt_row gt_right">0.51</td>
<td headers="smape" class="gt_row gt_right">3.18</td>
<td headers="rmse" class="gt_row gt_right">4875.10</td>
<td headers="rsq" class="gt_row gt_right">0.65</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level4">
<h4 id="step-4-forecast-the-test-data">Step 4: Forecast the Test Data<a class="anchor" aria-label="anchor" href="#step-4-forecast-the-test-data"></a>
</h4>
<p>Next, we need to forecast the test dataset. This is useful to
evaluate the model using a sampling of the time series within the panel
dataset. We use <code>modeltime_forecast(conf_by_id  = TRUE)</code> to
allow the confidence intervals (prediction intervals) to be calculated
by time series identifier. Note, that the
<code><a href="../reference/modeltime_calibrate.html">modeltime_calibrate()</a></code> must have been performed with an
<code>id</code> specified.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calib_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/modeltime_forecast.html">modeltime_forecast</a></span><span class="op">(</span></span>
<span>        new_data    <span class="op">=</span> <span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">testing</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span>,</span>
<span>        actual_data <span class="op">=</span> <span class="va">data_tbl</span>,</span>
<span>        conf_by_id  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_modeltime_forecast.html">plot_modeltime_forecast</a></span><span class="op">(</span></span>
<span>        .facet_ncol  <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        .interactive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="modeling-panel-data_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="step-5-refit-and-forecast-the-future">Step 5: Refit and Forecast the Future<a class="anchor" aria-label="anchor" href="#step-5-refit-and-forecast-the-future"></a>
</h4>
<p>We see that our global model performs well on this dataset. Now, we
will forecast the future.</p>
<div class="section level5">
<h5 id="refit-the-models">Refit the Models<a class="anchor" aria-label="anchor" href="#refit-the-models"></a>
</h5>
<p>The refitting step is needed to incorporate the most recent
information into our models. We use <code><a href="../reference/modeltime_refit.html">modeltime_refit()</a></code> to
update the model(s) in our modeltime tables.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">refit_tbl</span> <span class="op">&lt;-</span> <span class="va">calib_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/modeltime_refit.html">modeltime_refit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">refit_tbl</span></span>
<span><span class="co">#&gt; # Modeltime Table</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   .model_id .model     .model_desc .type .calibration_data</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 <span style="color: #949494;">&lt;workflow&gt;</span> XGBOOST     Test  <span style="color: #949494;">&lt;tibble [84 × 5]&gt;</span></span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="future-data">Future Data<a class="anchor" aria-label="anchor" href="#future-data"></a>
</h5>
<p>Next, make a future dataset using <code><a href="https://rdrr.io/pkg/timetk/man/future_frame.html" class="external-link">future_frame()</a></code> from
<code>timetk</code>, which creates future time stamps that extend
52-weeks into the future for each ID in the same panel structure needed
for our global forecast model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">future_tbl</span> <span class="op">&lt;-</span> <span class="va">data_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/timetk/man/future_frame.html" class="external-link">future_frame</a></span><span class="op">(</span>.length_out <span class="op">=</span> <span class="fl">52</span>, .bind_data <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">future_tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 364 × 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   id [7]</span></span></span>
<span><span class="co">#&gt;    id    date      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1_1   2012-11-02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1_1   2012-11-09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1_1   2012-11-16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1_1   2012-11-23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1_1   2012-11-30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1_1   2012-12-07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1_1   2012-12-14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1_1   2012-12-21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1_1   2012-12-28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1_1   2013-01-04</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 354 more rows</span></span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="future-predictions">Future Predictions<a class="anchor" aria-label="anchor" href="#future-predictions"></a>
</h5>
<p>Finally, we can forecast the future using our future data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">refit_tbl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/modeltime_forecast.html">modeltime_forecast</a></span><span class="op">(</span></span>
<span>    new_data    <span class="op">=</span> <span class="va">future_tbl</span>,</span>
<span>    actual_data <span class="op">=</span> <span class="va">data_tbl</span>, </span>
<span>    conf_by_id  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_modeltime_forecast.html">plot_modeltime_forecast</a></span><span class="op">(</span></span>
<span>    .interactive <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    .facet_ncol  <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="modeling-panel-data_files/figure-html/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>We’ve now successfully completed a <strong>Global Forecast.</strong>
You may find this challenging, especially if you are not familiar with
the Modeltime Workflow, terminology, or tidymodeling in R. If this is
the case, we have a solution. Take our high-performance forecasting
course.</p>
<div class="section level3">
<h3 id="take-the-high-performance-forecasting-course">Take the High-Performance Forecasting Course<a class="anchor" aria-label="anchor" href="#take-the-high-performance-forecasting-course"></a>
</h3>
<blockquote>
<p>Become the forecasting expert for your organization</p>
</blockquote>
<p><a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/" target="_blank" class="external-link"><img src="https://www.filepicker.io/api/file/bKyqVAi5Qi64sS05QYLk" alt="High-Performance Time Series Forecasting Course" width="100%" style="box-shadow: 0 0 5px 2px rgba(0, 0, 0, .5);"></a></p>
<p><a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/" class="external-link"><em>High-Performance
Time Series Course</em></a></p>
<div class="section level4">
<h4 id="time-series-is-changing">Time Series is Changing<a class="anchor" aria-label="anchor" href="#time-series-is-changing"></a>
</h4>
<p>Time series is changing. <strong>Businesses now need 10,000+ time
series forecasts every day.</strong> This is what I call a
<em>High-Performance Time Series Forecasting System (HPTSF)</em> -
Accurate, Robust, and Scalable Forecasting.</p>
<p><strong>High-Performance Forecasting Systems will save companies by
improving accuracy and scalability.</strong> Imagine what will happen to
your career if you can provide your organization a “High-Performance
Time Series Forecasting System” (HPTSF System).</p>
</div>
<div class="section level4">
<h4 id="how-to-learn-high-performance-time-series-forecasting">How to Learn High-Performance Time Series Forecasting<a class="anchor" aria-label="anchor" href="#how-to-learn-high-performance-time-series-forecasting"></a>
</h4>
<p>I teach how to build a HPTFS System in my <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting" class="external-link"><strong>High-Performance
Time Series Forecasting Course</strong></a>. You will learn:</p>
<ul>
<li>
<strong>Time Series Machine Learning</strong> (cutting-edge) with
<code>Modeltime</code> - 30+ Models (Prophet, ARIMA, XGBoost, Random
Forest, &amp; many more)</li>
<li>
<strong>Deep Learning</strong> with <code>GluonTS</code>
(Competition Winners)</li>
<li>
<strong>Time Series Preprocessing</strong>, Noise Reduction, &amp;
Anomaly Detection</li>
<li>
<strong>Feature engineering</strong> using lagged variables &amp;
external regressors</li>
<li><strong>Hyperparameter Tuning</strong></li>
<li><strong>Time series cross-validation</strong></li>
<li>
<strong>Ensembling</strong> Multiple Machine Learning &amp;
Univariate Modeling Techniques (Competition Winner)</li>
<li>
<strong>Scalable Forecasting</strong> - Forecast 1000+ time series
in parallel</li>
<li>and more.</li>
</ul>
<p class="text-center" style="font-size:24px;">
Become the Time Series Expert for your organization.
</p>
<br><p class="text-center" style="font-size:30px;">
<a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting" class="external-link">Take
the High-Performance Time Series Forecasting Course</a>
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Dancho.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
